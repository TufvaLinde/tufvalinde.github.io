<!DOCTYPE html>
<html lang="{{ page.lang | default: site.lang | default: 'en' }}">
  {%- include head.html -%}

  <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$','$$'], ['\\[', '\\]']]
      }
    };
  </script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" async></script>
  <script type="module" src="{{ '/assets/margin-notes.js' | relative_url }}"></script>
  <script type="module" src="{{ '/assets/sms-chat.js' | relative_url }}"></script>
  <script type="module" src="{{ '/assets/stop-motion.js' | relative_url }}"></script>
  <script src="{{ '/assets/annotations.js' | relative_url }}"></script>

<style>
  html, body {
    height: 100%;
    margin: 0;
    background: url("/assets/bgubt.webp") center / cover no-repeat;
    background-attachment: scroll;
  }

  h1 {
    font-weight: 850;
    word-spacing: 0.3em;
    width: 100%;
    margin-top: 30px;
    height: 70px;
    text-align: center;
    line-height: 1.1;
  }

  #ubt-title span {
    display: inline-block;
    padding: 0.08em 0.14em;
    margin: 0 0.02em;
    transition:
      font-family 0.15s linear,
      font-size 0.15s ease,
      transform 0.2s ease,
  }
</style>

<body>
  <div class="annot-wrapper">
    <h1 id="ubt-title">Ultimate Beach Tour</h1>

    <script>
      const fonts = [
        '"DM Serif Display", serif',
        '"Noto Serif Display", serif',
        '"EB Garamond", serif',
        '"Outfit", sans-serif',
        '"Open Sans", sans-serif',
        '"Silkscreen", cursive',
        '"Pixelify Sans", cursive',
        '"Coral Pixels", cursive',
        '"Playfair Display", serif',
        '"Abril Fatface", serif',
        '"Space Grotesk", sans-serif'
      ];

      const heading = document.getElementById("ubt-title");
      const originalText = heading.textContent;
      heading.textContent = "";

      const letters = [];

      [...originalText].forEach((char, i) => {
        const span = document.createElement("span");
        span.textContent = char;

        if (char !== " ") {
          span.dataset.font = i % fonts.length;
          span.style.fontFamily = fonts[span.dataset.font];
          span.style.fontSize = `${0.9 + Math.random() * 0.6}em`;
          span.style.borderWidth = `${1 + Math.random() * 3}px`;
          span.style.transform = `rotate(${Math.random() * 12 - 6}deg)`;
          span.style.fontWeight = Math.random() > 0.5 ? 800 : 400;
          span.style.fontStyle = Math.random() > 0.7 ? "italic" : "normal";
          span.style.textTransform = Math.random() > 0.8 ? "uppercase" : "none";
        } else {
          span.style.border = "none";
        }

        letters.push(span);
        heading.appendChild(span);
      });

      if (!window.matchMedia("(prefers-reduced-motion: reduce)").matches) {
        setInterval(() => {
          letters.forEach((span, i) => {
            if (!span.dataset.font) return;

            let f = (Number(span.dataset.font) + 1) % fonts.length;
            span.dataset.font = f;
            span.style.fontFamily = fonts[f];
            span.style.fontSize = `${0.5 + Math.random() * 0.3}em`;
            span.style.transform = `rotate(${Math.random() * 14 - 7}deg)`;
            span.style.fontWeight = [300, 400, 600, 800][Math.floor(Math.random() * 4)];
            span.style.fontStyle = Math.random() > 0.75 ? "italic" : "normal";
            span.style.textTransform = Math.random() > 0.85 ? "uppercase" : "none";
          });
        }, 200);
      }
    </script>

    <div class="ubt-grid">
      {{ content }}
    </div>
  </div>

  {%- include footer.html -%}
</body>
</html>
